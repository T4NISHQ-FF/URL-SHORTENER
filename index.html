<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>URL Shortener Pro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea, #764ba2);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 500px;
            margin: 50px auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 16px;
        }
        
        .tab.active {
            border-bottom: 3px solid #667eea;
            color: #667eea;
            font-weight: bold;
        }
        
        .form {
            display: none;
        }
        
        .form.active {
            display: block;
        }
        
        input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        
        button {
            width: 100%;
            padding: 12px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 10px;
        }
        
        button:hover {
            background: #5a6fd8;
        }
        
        .dashboard {
            display: none;
        }
        
        .url-item {
            background: #f9f9f9;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #667eea;
        }
        
        .notification {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            text-align: center;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Authentication Section -->
        <div id="authSection">
            <h1>üîó URL Shortener</h1>
            
            <div class="tabs">
                <button class="tab active" onclick="showTab('login')">Login</button>
                <button class="tab" onclick="showTab('register')">Register</button>
            </div>
            
            <!-- Login Form -->
            <div id="loginForm" class="form active">
                <input type="email" id="loginEmail" placeholder="Email Address">
                <input type="password" id="loginPassword" placeholder="Password">
                <button onclick="login()">Login</button>
                <p style="text-align: center; margin-top: 10px;">
                    <a href="#" onclick="showTab('forgot')">Forgot Password?</a>
                </p>
            </div>
            
            <!-- Register Form -->
            <div id="registerForm" class="form">
                <input type="text" id="regUsername" placeholder="Username">
                <input type="email" id="regEmail" placeholder="Email Address">
                <input type="password" id="regPassword" placeholder="Password">
                <input type="password" id="regConfirm" placeholder="Confirm Password">
                <button onclick="register()">Create Account</button>
            </div>
            
            <!-- Forgot Password Form -->
            <div id="forgotForm" class="form">
                <input type="email" id="forgotEmail" placeholder="Enter your email">
                <button onclick="forgotPassword()">Send Reset Link</button>
                <p style="text-align: center; margin-top: 10px;">
                    <a href="#" onclick="showTab('login')">Back to Login</a>
                </p>
            </div>
            
            <div id="authMessage"></div>
        </div>
        
        <!-- Dashboard Section -->
        <div id="dashboard" class="dashboard">
            <h1>Welcome, <span id="userName"></span>! üëã</h1>
            
            <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 20px 0;">
                <strong>Earnings: $<span id="userEarnings">0.00</span></strong> | 
                <strong>URLs: <span id="urlCount">0</span></strong> |
                <strong>Clicks: <span id="clickCount">0</span></strong>
            </div>
            
            <input type="url" id="longUrl" placeholder="Paste long URL here">
            <button onclick="shortenUrl()">Shorten URL</button>
            
            <div id="result" style="margin: 20px 0;"></div>
            
            <h3>Your Short URLs:</h3>
            <div id="urlList"></div>
            
            <button onclick="logout()" style="background: #dc3545; margin-top: 20px;">Logout</button>
            <button onclick="showAdmin()" style="background: #28a745; margin-top: 10px;">Admin Panel</button>
        </div>
        
        <!-- Admin Panel -->
        <div id="adminPanel" class="dashboard">
            <h1>Admin Panel üë®‚Äçüíº</h1>
            
            <div id="adminContent">
                <h3>All Users:</h3>
                <div id="userList"></div>
                
                <button onclick="clearAllData()" style="background: #dc3545;">Clear All Data</button>
                <button onclick="exportData()" style="background: #17a2b8;">Export Data</button>
                <button onclick="showDashboard()" style="background: #6c757d;">Back to Dashboard</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize storage
        function init() {
            if (!localStorage.getItem('users')) {
                const users = {
                    'admin@urlshortener.com': {
                        username: 'admin',
                        password: 'admin123',
                        email: 'admin@urlshortener.com',
                        earnings: 0,
                        urls: {},
                        isAdmin: true,
                        createdAt: new Date().toISOString()
                    }
                };
                localStorage.setItem('users', JSON.stringify(users));
            }
            
            // Check if user is already logged in
            const currentUser = localStorage.getItem('currentUser');
            if (currentUser) {
                showDashboard();
            }
        }
        
        // Tab management
        function showTab(tabName) {
            // Hide all forms
            document.querySelectorAll('.form').forEach(form => {
                form.classList.remove('active');
            });
            // Remove active from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected form and activate tab
            if (tabName === 'login') {
                document.getElementById('loginForm').classList.add('active');
                document.querySelectorAll('.tab')[0].classList.add('active');
            } else if (tabName === 'register') {
                document.getElementById('registerForm').classList.add('active');
                document.querySelectorAll('.tab')[1].classList.add('active');
            } else if (tabName === 'forgot') {
                document.getElementById('forgotForm').classList.add('active');
            }
            
            // Clear messages
            document.getElementById('authMessage').innerHTML = '';
        }
        
        // Authentication functions
        function register() {
            const username = document.getElementById('regUsername').value;
            const email = document.getElementById('regEmail').value;
            const password = document.getElementById('regPassword').value;
            const confirm = document.getElementById('regConfirm').value;
            
            if (!username || !email || !password) {
                showMessage('Please fill all fields', 'error');
                return;
            }
            
            if (password !== confirm) {
                showMessage('Passwords do not match', 'error');
                return;
            }
            
            const users = JSON.parse(localStorage.getItem('users'));
            
            if (users[email]) {
                showMessage('Email already registered', 'error');
                return;
            }
            
            users[email] = {
                username: username,
                password: password, // In real app, hash this
                email: email,
                earnings: 0,
                urls: {},
                isAdmin: false,
                createdAt: new Date().toISOString()
            };
            
            localStorage.setItem('users', JSON.stringify(users));
            showMessage('Account created successfully! Please login.', 'success');
            showTab('login');
        }
        
        function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            const users = JSON.parse(localStorage.getItem('users'));
            const user = users[email];
            
            if (user && user.password === password) {
                localStorage.setItem('currentUser', email);
                showDashboard();
            } else {
                showMessage('Invalid email or password', 'error');
            }
        }
        
        function forgotPassword() {
            const email = document.getElementById('forgotEmail').value;
            showMessage(`Password reset link sent to ${email}`, 'success');
        }
        
        function logout() {
            localStorage.removeItem('currentUser');
            showAuth();
        }
        
        // URL shortening
        function shortenUrl() {
            const currentUser = localStorage.getItem('currentUser');
            if (!currentUser) {
                showMessage('Please login first', 'error');
                return;
            }
            
            const longUrl = document.getElementById('longUrl').value;
            if (!longUrl) {
                showMessage('Please enter a URL', 'error');
                return;
            }
            
            const shortCode = Math.random().toString(36).substring(2, 8);
            const shortUrl = `${window.location.origin}/URL-SHORTENER/s/${shortCode}`;
            
            const users = JSON.parse(localStorage.getItem('users'));
            users[currentUser].urls[shortCode] = {
                longUrl: longUrl,
                clicks: 0,
                earnings: 0,
                created: new Date().toLocaleString()
            };
            
            localStorage.setItem('users', JSON.stringify(users));
            
            document.getElementById('result').innerHTML = `
                <div class="success notification">
                    <strong>‚úÖ URL Shortened!</strong><br>
                    <input type="text" value="${shortUrl}" readonly 
                           style="width: 100%; padding: 5px; margin: 5px 0; border: 1px solid #ccc;">
                    <button onclick="copyUrl('${shortUrl}')">Copy</button>
                </div>
            `;
            
            document.getElementById('longUrl').value = '';
            loadDashboard();
        }
        
        function copyUrl(url) {
            navigator.clipboard.writeText(url);
            alert('URL copied to clipboard!');
        }
        
        // Dashboard functions
        function showAuth() {
            document.getElementById('authSection').style.display = 'block';
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('adminPanel').style.display = 'none';
        }
        
        function showDashboard() {
            document.getElementById('authSection').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            document.getElementById('adminPanel').style.display = 'none';
            loadDashboard();
        }
        
        function showAdmin() {
            const currentUser = localStorage.getItem('currentUser');
            const users = JSON.parse(localStorage.getItem('users'));
            
            if (users[currentUser] && users[currentUser].isAdmin) {
                document.getElementById('authSection').style.display = 'none';
                document.getElementById('dashboard').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                loadAdminPanel();
            } else {
                alert('Admin access required');
            }
        }
        
        function loadDashboard() {
            const currentUser = localStorage.getItem('currentUser');
            if (!currentUser) return;
            
            const users = JSON.parse(localStorage.getItem('users'));
            const user = users[currentUser];
            
            document.getElementById('userName').textContent = user.username;
            document.getElementById('userEarnings').textContent = user.earnings.toFixed(2);
            document.getElementById('urlCount').textContent = Object.keys(user.urls).length;
            
            let totalClicks = 0;
            Object.values(user.urls).forEach(url => {
                totalClicks += url.clicks;
            });
            document.getElementById('clickCount').textContent = totalClicks;
            
            // Load URL list
            let urlListHTML = '';
            Object.entries(user.urls).forEach(([code, url]) => {
                urlListHTML += `
                    <div class="url-item">
                        <strong>/${code}</strong><br>
                        <small>${url.longUrl}</small><br>
                        <small>Clicks: ${url.clicks} | Earnings: $${url.earnings.toFixed(2)}</small>
                    </div>
                `;
            });
            document.getElementById('urlList').innerHTML = urlListHTML || '<p>No URLs yet. Create your first one!</p>';
        }
        
        function loadAdminPanel() {
            const users = JSON.parse(localStorage.getItem('users'));
            let userListHTML = '';
            
            Object.entries(users).forEach(([email, user]) => {
                userListHTML += `
                    <div class="url-item">
                        <strong>${user.username}</strong> ${user.isAdmin ? '(Admin)' : ''}<br>
                        <small>Email: ${email}</small><br>
                        <small>URLs: ${Object.keys(user.urls).length} | Earnings: $${user.earnings.toFixed(2)}</small>
                    </div>
                `;
            });
            
            document.getElementById('userList').innerHTML = userListHTML;
        }
        
        // Utility functions
        function showMessage(message, type) {
            document.getElementById('authMessage').innerHTML = `
                <div class="${type} notification">${message}</div>
            `;
        }
        
        function clearAllData() {
            if (confirm('Clear ALL data? This cannot be undone!')) {
                localStorage.clear();
                init();
                alert('All data cleared!');
                showAuth();
            }
        }
        
        function exportData() {
            const data = localStorage.getItem('users');
            const blob = new Blob([data], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'urlshortener-data.json';
            a.click();
        }
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
