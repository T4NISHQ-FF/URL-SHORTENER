<!DOCTYPE html>
<html>
<head>
    <title>FF Shortener - User System</title>
    <style>
        body { font-family: Arial; max-width: 600px; margin: 50px auto; padding: 20px; }
        .tab { display: none; }
        .active { display: block; }
        input, button { padding: 10px; margin: 5px; width: 100%; }
    </style>
</head>
<body>
    <!-- Login/Register Tabs -->
    <div id="authTabs">
        <button onclick="showTab('login')">Login</button>
        <button onclick="showTab('register')">Register</button>
    </div>

    <!-- Login Tab -->
    <div id="login" class="tab active">
        <h3>Login to Your Account</h3>
        <input type="text" id="loginUsername" placeholder="Username">
        <input type="password" id="loginPassword" placeholder="Password">
        <button onclick="login()">Login</button>
    </div>

    <!-- Register Tab -->
    <div id="register" class="tab">
        <h3>Create Account</h3>
        <input type="text" id="regUsername" placeholder="Username">
        <input type="password" id="regPassword" placeholder="Password">
        <input type="text" id="regEmail" placeholder="Email (for payments)">
        <button onclick="register()">Register</button>
    </div>

    <!-- Shortener (shown after login) -->
    <div id="shortener" class="tab" style="display:none">
        <h2>Welcome, <span id="userDisplay"></span>! ðŸŽ‰</h2>
        <p>Earnings: $<span id="userEarnings">0.00</span></p>
        
        <input type="url" id="longUrl" placeholder="Enter URL to shorten">
        <button onclick="shortenUrl()">Shorten & Earn</button>
        <div id="result"></div>

        <h3>Your Short URLs:</h3>
        <div id="userUrls"></div>
    </div>

    <script>
        // User management
        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.style.display = 'none');
            document.getElementById(tabName).style.display = 'block';
        }

        function register() {
            const username = document.getElementById('regUsername').value;
            const password = document.getElementById('regPassword').value;
            const email = document.getElementById('regEmail').value;
            
            if (!username || !password) return alert('Fill all fields');
            
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            if (users[username]) return alert('Username exists');
            
            users[username] = { password, email, earnings: 0, urls: {} };
            localStorage.setItem('users', JSON.stringify(users));
            alert('Account created! Login now.');
            showTab('login');
        }

        function login() {
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            if (users[username] && users[username].password === password) {
                localStorage.setItem('currentUser', username);
                showUserDashboard(username);
            } else {
                alert('Invalid login');
            }
        }

        function showUserDashboard(username) {
            document.getElementById('authTabs').style.display = 'none';
            document.getElementById('userDisplay').textContent = username;
            updateEarningsDisplay(username);
            document.getElementById('shortener').style.display = 'block';
        }

        function shortenUrl() {
            const username = localStorage.getItem('currentUser');
            if (!username) return alert('Please login');
            
            const longUrl = document.getElementById('longUrl').value;
            if (!longUrl) return alert('Enter URL');
            
            const shortCode = Math.random().toString(36).substring(2, 8);
            const shortUrl = window.location.origin + '/URL-SHORTENER/s/' + shortCode;
            
            // Save to user's account
            const users = JSON.parse(localStorage.getItem('users'));
            users[username].urls[shortCode] = {
                longUrl: longUrl,
                clicks: 0,
                created: new Date().toISOString()
            };
            localStorage.setItem('users', JSON.stringify(users));
            
            document.getElementById('result').innerHTML = 
                `Short URL: <input value="${shortUrl}" readonly> 
                 <button onclick="copyUrl('${shortUrl}')">Copy</button>`;
        }

        function updateEarningsDisplay(username) {
            const users = JSON.parse(localStorage.getItem('users'));
            document.getElementById('userEarnings').textContent = 
                users[username].earnings.toFixed(2);
        }

        function copyUrl(url) {
            navigator.clipboard.writeText(url);
            alert('Copied!');
        }

        // Auto-login if already logged in
        const currentUser = localStorage.getItem('currentUser');
        if (currentUser) {
            showUserDashboard(currentUser);
        }
    </script>
</body>
</html>
